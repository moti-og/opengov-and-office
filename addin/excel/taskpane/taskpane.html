<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OpenGov Office Sync</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š Excel Sync</h1>
        
        <div class="sync-indicator">
            <div id="syncDot" class="dot"></div>
            <span id="syncLabel">Initializing...</span>
        </div>
        
        <!-- Section 1: Spreadsheet Sync -->
        <div class="section">
            <h2>ðŸ“Š Spreadsheet Sync</h2>
            <p class="section-description">Real-time bidirectional sync with editable web grid</p>
            
            <div id="spreadsheetRanges" class="range-list">
                <div class="range-item" data-index="0">
                    <span class="drag-handle">â‰¡</span>
                    <input type="text" class="range-input" placeholder="e.g. A1:F10" value="A1:F10" />
                    <button class="remove-range-btn" title="Remove range">Ã—</button>
                </div>
            </div>
            <button id="addSpreadsheetRange" class="add-range-btn">+ Add Range</button>
            <button id="syncSpreadsheetBtn" class="sync-btn">Sync to Spreadsheet</button>
        </div>
        
        <!-- Section 2: Budget Book -->
        <div class="section budget-book-section">
            <h2>ðŸ“– Budget Book</h2>
            <p class="section-description">Capture screenshots for formatted budget view</p>
            
            <div id="budgetRanges" class="range-list">
                <div class="range-item" data-index="0">
                    <span class="drag-handle">â‰¡</span>
                    <input type="text" class="range-input" placeholder="e.g. A1:F10" value="A1:F10" />
                    <button class="remove-range-btn" title="Remove range">Ã—</button>
                </div>
            </div>
            <button id="addBudgetRange" class="add-range-btn">+ Add Range</button>
            <button id="updateBudgetBtn" class="budget-btn">Update Budget Book</button>
        </div>
    </div>
    
    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-icon">âœ…</div>
            <h3>Success!</h3>
            <p>The sheet contents have been added to your budget book</p>
        </div>
    </div>
    
    <script src="taskpane.js"></script>
</body>
</html>
